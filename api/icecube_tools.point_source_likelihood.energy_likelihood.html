<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>icecube_tools.point_source_likelihood.energy_likelihood module &mdash; icecube_tools v3.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="icecube_tools.point_source_likelihood.point_source_likelihood module" href="icecube_tools.point_source_likelihood.point_source_likelihood.html" />
    <link rel="prev" title="icecube_tools.point_source_likelihood package" href="icecube_tools.point_source_likelihood.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> icecube_tools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/public_data_access.html">Data access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/detector_model.html">Detector model interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/source_model.html">Source model interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/simulation.html">Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/point_source_likelihood.html">Point source likelihood</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#icecube-tools">icecube_tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">icecube_tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="api.html">API</a> &raquo;</li>
          <li><a href="icecube_tools.html">icecube_tools package</a> &raquo;</li>
          <li><a href="icecube_tools.point_source_likelihood.html">icecube_tools.point_source_likelihood package</a> &raquo;</li>
      <li>icecube_tools.point_source_likelihood.energy_likelihood module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/icecube_tools.point_source_likelihood.energy_likelihood.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="module-icecube_tools.point_source_likelihood.energy_likelihood">
<span id="icecube-tools-point-source-likelihood-energy-likelihood-module"></span><h1>icecube_tools.point_source_likelihood.energy_likelihood module<a class="headerlink" href="#module-icecube_tools.point_source_likelihood.energy_likelihood" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">icecube_tools.point_source_likelihood.energy_likelihood.</span></span><span class="sig-name descname"><span class="pre">MarginalisedEnergyLikelihood</span></span><a class="headerlink" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for the marginalised energy likelihood.</p>
<p>L = int d Etrue P(Ereco | Etrue) P(Etrue | index) = P(Ereco | index).</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood2021">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">icecube_tools.point_source_likelihood.energy_likelihood.</span></span><span class="sig-name descname"><span class="pre">MarginalisedEnergyLikelihood2021</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'h5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_sind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ebins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood2021" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood" title="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood"><code class="xref py py-class docutils literal notranslate"><span class="pre">MarginalisedEnergyLikelihood</span></code></a></p>
<p>Compute the marginalised energy likelihood by reading in the provided IRF data of 2021.
Creates instances of MarginalisedEnergyLikelihoodFromSimFixedIndex (slightly copied from
MarginalisedEnergyLikelihoodFromSim but with different interpolating) for each given index.
If the likelihood is requested for an index not provided with a dataset,
the likelihood will be interpolated (linearly) between provided indices.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood2021.calc_loglike">
<span class="sig-name descname"><span class="pre">calc_loglike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood2021.calc_loglike" title="Permalink to this definition"></a></dt>
<dd><p>Function intended for testing only.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihoodBraun2008">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">icecube_tools.point_source_likelihood.energy_likelihood.</span></span><span class="sig-name descname"><span class="pre">MarginalisedEnergyLikelihoodBraun2008</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihoodBraun2008" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood" title="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood"><code class="xref py py-class docutils literal notranslate"><span class="pre">MarginalisedEnergyLikelihood</span></code></a></p>
<p>Compute the marginalised enegry likelihood using 
Figure 4 in Braun+2008.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihoodFixed">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">icecube_tools.point_source_likelihood.energy_likelihood.</span></span><span class="sig-name descname"><span class="pre">MarginalisedEnergyLikelihoodFixed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_sind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ebins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihoodFixed" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood" title="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood"><code class="xref py py-class docutils literal notranslate"><span class="pre">MarginalisedEnergyLikelihood</span></code></a></p>
<p>Compute the marginalised energy likelihood for a fixed case based on a simulation.
Eg. P(E | atmos + diffuse astro).</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihoodFromSim">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">icecube_tools.point_source_likelihood.energy_likelihood.</span></span><span class="sig-name descname"><span class="pre">MarginalisedEnergyLikelihoodFromSim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_sind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ebins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihoodFromSim" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood" title="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood"><code class="xref py py-class docutils literal notranslate"><span class="pre">MarginalisedEnergyLikelihood</span></code></a></p>
<p>Compute the marginalised energy likelihood by using a 
simulation of a large number of reconstructed muon 
neutrino tracks.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihoodFromSim.set_src_dec">
<span class="sig-name descname"><span class="pre">set_src_dec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_dec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihoodFromSim.set_src_dec" title="Permalink to this definition"></a></dt>
<dd><p>Set the source declination in private variable
Precompute likelihood distributions</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihoodFromSimFixedIndex">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">icecube_tools.point_source_likelihood.energy_likelihood.</span></span><span class="sig-name descname"><span class="pre">MarginalisedEnergyLikelihoodFromSimFixedIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_sind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ebins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihoodFromSimFixedIndex" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood" title="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihood"><code class="xref py py-class docutils literal notranslate"><span class="pre">MarginalisedEnergyLikelihood</span></code></a></p>
<p>Copied from MarginalisedEnergyLikelihoodFromSim but without the interpolating</p>
<dl class="py property">
<dt class="sig sig-object py" id="icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihoodFromSimFixedIndex.src_dec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">src_dec</span></span><a class="headerlink" href="#icecube_tools.point_source_likelihood.energy_likelihood.MarginalisedEnergyLikelihoodFromSimFixedIndex.src_dec" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icecube_tools.point_source_likelihood.energy_likelihood.read_input_from_file">
<span class="sig-prename descclassname"><span class="pre">icecube_tools.point_source_likelihood.energy_likelihood.</span></span><span class="sig-name descname"><span class="pre">read_input_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#icecube_tools.point_source_likelihood.energy_likelihood.read_input_from_file" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to read in data digitized from plots.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icecube_tools.point_source_likelihood.energy_likelihood.reweight_spectrum">
<span class="sig-prename descclassname"><span class="pre">icecube_tools.point_source_likelihood.energy_likelihood.</span></span><span class="sig-name descname"><span class="pre">reweight_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#icecube_tools.point_source_likelihood.energy_likelihood.reweight_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Use energies from a simulation with a harder 
spectral index for efficiency.</p>
<p>The spectrum is then resampled from the 
weighted histogram</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>energies</strong> – Energies to be reiweghted.</p>
</dd>
<dt class="field-even">Sim_index</dt>
<dd class="field-even"><p>Spectral index of the simulation.</p>
</dd>
<dt class="field-odd">New_index</dt>
<dd class="field-odd"><p>Spectral index to reweight to.</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="icecube_tools.point_source_likelihood.html" class="btn btn-neutral float-left" title="icecube_tools.point_source_likelihood package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="icecube_tools.point_source_likelihood.point_source_likelihood.html" class="btn btn-neutral float-right" title="icecube_tools.point_source_likelihood.point_source_likelihood module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Francesca Capel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>