{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "2eab4120",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-16T12:13:30.661138Z",
     "iopub.status.busy": "2023-05-16T12:13:30.660770Z",
     "iopub.status.idle": "2023-05-16T12:13:32.014774Z",
     "shell.execute_reply": "2023-05-16T12:13:32.013871Z"
    }
   },
   "outputs": [],
   "source": [
    "from icecube_tools.utils.data import SimEvents, RealEvents\n",
    "\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9350dbc2",
   "metadata": {},
   "source": [
    "## Event classes\n",
    "\n",
    "\n",
    "Events of simulations and events detected by icecube are stored in instances of `SimEvents` and `RealEvents`, respectively. We load some simulated events:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "a80ab53d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-16T12:13:32.019998Z",
     "iopub.status.busy": "2023-05-16T12:13:32.019239Z",
     "iopub.status.idle": "2023-05-16T12:13:32.030258Z",
     "shell.execute_reply": "2023-05-16T12:13:32.029489Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Resetting rng\n"
     ]
    }
   ],
   "source": [
    "events = SimEvents.load_from_h5(\"multi_test.hdf5\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2fcef012",
   "metadata": {},
   "source": [
    "Events can span multiple data seasons. For each season, one entry is stored in `periods`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "d5d9f792",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-16T12:13:32.034255Z",
     "iopub.status.busy": "2023-05-16T12:13:32.033729Z",
     "iopub.status.idle": "2023-05-16T12:13:32.041602Z",
     "shell.execute_reply": "2023-05-16T12:13:32.040960Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['IC86_I', 'IC86_II']"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "events._data_periods"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "83efd2cb",
   "metadata": {},
   "source": [
    "The properties of the event are stored as properties. A list of all data fields is accessible through"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "b045a913",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-16T12:13:32.046420Z",
     "iopub.status.busy": "2023-05-16T12:13:32.045662Z",
     "iopub.status.idle": "2023-05-16T12:13:32.051968Z",
     "shell.execute_reply": "2023-05-16T12:13:32.051134Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['true_energy',\n",
       " 'arrival_energy',\n",
       " 'reco_energy',\n",
       " 'ra',\n",
       " 'dec',\n",
       " 'ang_err',\n",
       " 'source_label']"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "events.keys"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "609e1d66",
   "metadata": {},
   "source": [
    "The entries differ for simulated and actual events.\n",
    "\n",
    "For each period a dictionary of all such data fields is returned by `period(p)`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "c0a90604",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-16T12:13:32.056074Z",
     "iopub.status.busy": "2023-05-16T12:13:32.055384Z",
     "iopub.status.idle": "2023-05-16T12:13:32.077547Z",
     "shell.execute_reply": "2023-05-16T12:13:32.076669Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'true_energy': array([  665.17799971,   169.20224047,  2704.76856955,   222.53233004,\n",
       "          719.42338092,   113.76638539,  1306.03424485,   558.38820466,\n",
       "         3687.46173024,   215.58493772,   280.95879564,   133.30873344,\n",
       "          301.89838943,  1398.13513754,   767.65278968,   118.64413893,\n",
       "          160.41866721,   118.92767322,   194.1523479 ,   120.64765736,\n",
       "         1848.92419433,   123.8664367 ,   185.02169194,   327.92799311,\n",
       "         1037.84104796,   266.12184725,   159.7771837 ,   430.93367644,\n",
       "          518.3734617 ,   750.98295075,  1049.23778098,   264.52434044,\n",
       "          441.57855045,   407.24088006,   932.72646932,   217.33690464,\n",
       "          668.48709395,   840.3069546 ,   221.64523495,   129.24528277,\n",
       "          201.30348814,   813.91844844,   165.42668338,  2392.19344772,\n",
       "          306.01672199,   619.26394335,   205.54118511,   183.54452834,\n",
       "          444.54702491,   286.7308729 ,  1103.89935252,   125.32529652,\n",
       "         4221.01626458,  6159.45017066,   189.97672756,   151.52806977,\n",
       "          264.03969804,   409.40883107,  1370.78069197,  1073.11171141,\n",
       "          120.97175792,   202.50149386,  1074.16230111,   707.67977827,\n",
       "          167.33680634,   304.80286617,   174.82402499,  1178.99103051,\n",
       "          260.61484975,   704.4584648 ,   112.63250037,   374.47334873,\n",
       "          436.16340875,   144.31224983,   681.88996726,   306.18139883,\n",
       "          187.09052642,  1045.77839849,   338.45237683,   113.81121899,\n",
       "          554.22164427,   280.23629107,   379.65455852,   165.72335547,\n",
       "          159.8683858 ,  1004.30764957,   106.34627805,   163.15374225,\n",
       "          716.31384524,   384.22744342,   467.50601569,   190.80454181,\n",
       "          216.94108105,   416.99727371,   168.0905097 ,   161.33563558,\n",
       "          466.36233206,  1167.84633208,   176.7223084 ,   627.31400085,\n",
       "          356.98882519,  6285.30740961,   838.67204211,   186.52119779,\n",
       "          278.24304309, 29864.37775134,   111.06740162,   179.42177353,\n",
       "          171.20408886,   310.4591679 ,   158.94575503,   181.60940071,\n",
       "          253.04695364,  1053.56576923,  1307.69889586,  1208.04514262,\n",
       "          634.40252458,   102.97534251,   462.34736935,   588.58037011,\n",
       "          129.80819391,   570.16105241,   204.7735844 ,  1884.27360298,\n",
       "         1040.51986105,   176.14371957,  1285.92841635,   315.15457001,\n",
       "          242.40687436,  1025.75297438,   109.81764027,   150.17963854,\n",
       "          660.6902692 ,   264.5571498 ,   171.13200095,   234.6779858 ,\n",
       "          757.16327404,  1047.43788847,   117.88453721,   275.86734678,\n",
       "          273.08905125,  2640.2094381 ,  2253.81021821,   413.21565759,\n",
       "          338.81161596,   493.44180041,  1739.91932914,   214.10729084,\n",
       "          183.65542837,   536.77396307,   440.71671286,  3069.47692519,\n",
       "          539.20624152,   318.97481387,  1160.03726084,   318.66308187,\n",
       "          518.00239252,   186.60279408,   180.6676692 ,   565.24556756,\n",
       "          109.34846318,   158.05166292,   294.35893225,   206.80785434,\n",
       "        26175.56870109,   817.40499178,   295.22200044,  1352.36210133,\n",
       "          114.47630726,  1170.56077299,  3187.49911199,   777.55454508,\n",
       "         6729.62051088,  1212.0632022 ,  1608.93956318,   180.43329609,\n",
       "          274.13763443,   271.40221337,   148.32800478,   780.40790433,\n",
       "          629.93704299,   849.59835782,   214.81348121,  1347.01170003,\n",
       "         1058.41920588,   301.32661781,   289.93859589,   108.88803252,\n",
       "          658.57988291,   184.30192209,   662.57223211,   109.75416985,\n",
       "         1865.35570976,   278.13226164,   923.53771418,   300.92900239,\n",
       "         1029.53347916,   196.39103338,   253.23194208,  1164.73115683,\n",
       "         4917.24372821,   636.33882215,   354.58479897,  1088.53462058,\n",
       "          270.05701745,   377.15536744,  1938.24868659,   254.24823487,\n",
       "          173.84678917,   251.16417039,   192.61306574,   419.50709591,\n",
       "          628.86089756,  1152.82969815,   896.2325109 ,   696.42648681,\n",
       "         1717.55668084,   305.78921079,   337.25324592,   172.45712477,\n",
       "          693.54556435,   188.71621532,  4663.91416639,   473.36988195,\n",
       "          115.42204314,  2379.70097025,   257.64850385,   735.81786299,\n",
       "          164.25801428,  8109.58633028,   861.49657765,   111.40882983,\n",
       "          725.26690219,   170.68372757,   136.49957361,   314.10713994,\n",
       "         1476.50899661,   121.18799382,  1380.7462448 ,  1874.65024421,\n",
       "         1078.71253455,  1794.23243858,   117.4010008 ,  1187.00047048,\n",
       "          589.71414514,   192.33678829,   437.82329142,   657.01433569,\n",
       "          242.99141263,   271.22233494, 12683.1087396 ,   408.29075101,\n",
       "          406.04040503,  1813.76569574,   775.45442419,   368.59531327,\n",
       "         1256.2679978 ,  1896.43587262,  1075.0111594 ,  1489.80344627,\n",
       "          275.20703124,   540.35160675,   408.65471764,   450.73095688,\n",
       "          223.05041231,   364.17793445,   108.50505695,   221.84454619,\n",
       "          778.27632446,   117.45806125,  1300.33860539,   272.76603908,\n",
       "          649.08534384,  1152.08021331,   234.58879622,  1615.53833905,\n",
       "          173.85925604, 76408.66548679,  1987.78756539,  2061.21885186,\n",
       "         4299.03682388, 24664.82340051, 26276.70028567,   221.902938  ,\n",
       "         6175.69235272,   265.10753412,  1947.87805191,   639.12185654,\n",
       "        10923.27083119, 11003.76235017, 15527.57218007,   786.28909582,\n",
       "         5488.42991934,  4608.48387777,  2086.14164665, 33050.85440657,\n",
       "          106.91961995, 32176.94562562,   635.66803767, 31049.25577361,\n",
       "         4296.20758203,  2599.95397702,   854.68120812, 19196.25790662,\n",
       "         3433.75660866,  5613.30383391,  4038.86628583,   445.72990803,\n",
       "        25146.86829523,   700.05722028,   883.18722375, 91849.78186613,\n",
       "        11784.98057907,   884.63121066,   967.43195317,   290.07242411]),\n",
       " 'reco_energy': array([ 563.97767998,  512.10080143,  613.35895407,  861.57390129,\n",
       "         546.45661588,  688.96200449, 1116.86714984,  546.45661588,\n",
       "         740.79722222,  512.10080143,  861.57390129,  688.96200449,\n",
       "        1051.31086066,  613.35895407,  936.39582501, 1044.43409931,\n",
       "         512.10080143,  861.57390129,  688.96200449, 1051.31086066,\n",
       "         613.35895407,  512.10080143,  861.57390129,  546.45661588,\n",
       "         613.35895407,  688.96200449,  512.10080143,  546.45661588,\n",
       "         936.39582501,  736.2540416 ,  613.35895407,  512.10080143,\n",
       "         563.97767998,  546.45661588,  936.39582501,  861.57390129,\n",
       "         546.45661588,  936.39582501,  512.10080143,  861.57390129,\n",
       "         688.96200449,  546.45661588,  512.10080143,  613.35895407,\n",
       "         861.57390129,  936.39582501,  688.96200449,  512.10080143,\n",
       "         546.45661588,  861.57390129,  613.35895407,  688.96200449,\n",
       "         740.79722222,  818.65935905,  535.020037  , 1051.31086066,\n",
       "        1044.43409931,  936.39582501,  613.35895407, 1116.86714984,\n",
       "         535.020037  ,  512.10080143,  872.47456533,  563.97767998,\n",
       "         861.57390129,  688.96200449, 1051.31086066, 1457.21628634,\n",
       "         512.10080143,  546.45661588,  861.57390129,  936.39582501,\n",
       "         736.2540416 ,  688.96200449, 1185.11531395, 1051.31086066,\n",
       "        1044.43409931,  613.35895407, 1175.94625249,  512.10080143,\n",
       "         546.45661588,  861.57390129,  546.45661588,  512.10080143,\n",
       "         535.020037  ,  613.35895407,  512.10080143,  512.10080143,\n",
       "         546.45661588,  936.39582501,  563.97767998,  512.10080143,\n",
       "         861.57390129,  546.45661588,  688.96200449, 1051.31086066,\n",
       "         936.39582501,  678.09345575,  512.10080143,  563.97767998,\n",
       "         563.97767998,  818.65935905,  928.32974114,  512.10080143,\n",
       "         512.10080143, 1107.30614051,  861.57390129,  535.020037  ,\n",
       "         688.96200449, 1051.31086066,  850.23649693, 1044.43409931,\n",
       "         564.65179665,  613.35895407, 1116.86714984,  613.35895407,\n",
       "         546.45661588,  535.020037  ,  936.39582501,  563.97767998,\n",
       "         850.23649693,  736.2540416 ,  512.10080143,  678.09345575,\n",
       "        1116.86714984,  512.10080143,  613.35895407,  861.57390129,\n",
       "         688.96200449, 1116.86714984, 1051.31086066, 1044.43409931,\n",
       "         546.45661588,  564.65179665,  567.29209685,  512.10080143,\n",
       "         546.45661588,  613.35895407,  861.57390129,  688.96200449,\n",
       "        1051.31086066, 1116.86714984,  872.47456533,  936.39582501,\n",
       "         736.2540416 ,  546.45661588,  613.35895407,  512.10080143,\n",
       "         861.57390129,  936.39582501,  736.2540416 ,  678.09345575,\n",
       "         546.45661588,  936.39582501,  613.35895407,  563.97767998,\n",
       "         736.2540416 ,  512.10080143,  512.10080143,  546.45661588,\n",
       "         861.57390129,  535.020037  ,  688.96200449, 1051.31086066,\n",
       "         932.8406712 ,  546.45661588,  512.10080143,  613.35895407,\n",
       "         861.57390129, 1116.86714984,  740.79722222,  936.39582501,\n",
       "        1571.21870165,  613.35895407, 1116.86714984,  512.10080143,\n",
       "         861.57390129,  688.96200449, 1051.31086066,  546.45661588,\n",
       "         936.39582501,  563.97767998,  512.10080143,  613.35895407,\n",
       "         678.09345575,  535.020037  ,  861.57390129,  688.96200449,\n",
       "         736.2540416 , 1051.31086066,  546.45661588,  512.10080143,\n",
       "         678.09345575,  861.57390129,  936.39582501,  688.96200449,\n",
       "         613.35895407, 1051.31086066,  535.020037  , 1116.86714984,\n",
       "         740.79722222,  736.2540416 , 1185.11531395,  613.35895407,\n",
       "         512.10080143,  546.45661588, 1116.86714984,  861.57390129,\n",
       "         688.96200449, 1051.31086066, 1044.43409931,  936.39582501,\n",
       "         546.45661588,  613.35895407,  936.39582501,  736.2540416 ,\n",
       "        1116.86714984,  512.10080143,  563.97767998,  861.57390129,\n",
       "         546.45661588,  512.10080143,  740.79722222,  936.39582501,\n",
       "         861.57390129,  613.35895407,  512.10080143,  563.97767998,\n",
       "         861.57390129,  740.79722222,  546.45661588,  688.96200449,\n",
       "         936.39582501,  512.10080143,  535.020037  ,  861.57390129,\n",
       "         613.35895407,  688.96200449,  613.35895407, 1116.86714984,\n",
       "         872.47456533, 1457.21628634,  535.020037  , 1444.49131786,\n",
       "         546.45661588,  512.10080143,  936.39582501,  736.2540416 ,\n",
       "         861.57390129,  850.23649693,  932.8406712 , 1185.11531395,\n",
       "        1175.94625249,  712.74377547,  563.97767998,  602.82203415,\n",
       "         716.13085798,  613.35895407, 1116.86714984,  872.47456533,\n",
       "         512.10080143,  546.45661588,  563.97767998,  563.97767998,\n",
       "         512.10080143,  546.45661588,  861.57390129,  688.96200449,\n",
       "         936.39582501, 1051.31086066,  613.35895407,  535.020037  ,\n",
       "         546.45661588, 1116.86714984,  512.10080143,  872.47456533,\n",
       "         850.23649693, 1146.80997392,  613.35895407, 1116.86714984,\n",
       "         740.79722222,  932.8406712 , 2599.63519417,  512.10080143,\n",
       "        1571.21870165,  861.57390129,  872.47456533,  546.45661588,\n",
       "        1673.49711429, 4082.93627166, 4017.01926303,  936.39582501,\n",
       "        1143.30793704, 2225.41992334, 1457.21628634, 4691.10503594,\n",
       "         688.96200449, 2558.48941238,  736.2540416 , 1135.99858264,\n",
       "        2189.85629643, 1444.49131786, 1185.11531395, 1146.73799273,\n",
       "         876.50522991,  883.57468076, 2338.16847287, 1175.94625249,\n",
       "        4291.9863558 ,  602.82203415,  605.65468115, 8332.28231423,\n",
       "        9402.84211149, 1213.69320085, 1987.24417699, 1051.31086066]),\n",
       " 'arrival_energy': array([  665.17799971,   169.20224047,  2704.76856955,   222.53233004,\n",
       "          719.42338092,   113.76638539,  1306.03424485,   558.38820466,\n",
       "         3687.46173024,   215.58493772,   280.95879564,   133.30873344,\n",
       "          301.89838943,  1398.13513754,   767.65278968,   118.64413893,\n",
       "          160.41866721,   118.92767322,   194.1523479 ,   120.64765736,\n",
       "         1848.92419433,   123.8664367 ,   185.02169194,   327.92799311,\n",
       "         1037.84104796,   266.12184725,   159.7771837 ,   430.93367644,\n",
       "          518.3734617 ,   750.98295075,  1049.23778098,   264.52434044,\n",
       "          441.57855045,   407.24088006,   932.72646932,   217.33690464,\n",
       "          668.48709395,   840.3069546 ,   221.64523495,   129.24528277,\n",
       "          201.30348814,   813.91844844,   165.42668338,  2392.19344772,\n",
       "          306.01672199,   619.26394335,   205.54118511,   183.54452834,\n",
       "          444.54702491,   286.7308729 ,  1103.89935252,   125.32529652,\n",
       "         4221.01626458,  6159.45017066,   189.97672756,   151.52806977,\n",
       "          264.03969804,   409.40883107,  1370.78069197,  1073.11171141,\n",
       "          120.97175792,   202.50149386,  1074.16230111,   707.67977827,\n",
       "          167.33680634,   304.80286617,   174.82402499,  1178.99103051,\n",
       "          260.61484975,   704.4584648 ,   112.63250037,   374.47334873,\n",
       "          436.16340875,   144.31224983,   681.88996726,   306.18139883,\n",
       "          187.09052642,  1045.77839849,   338.45237683,   113.81121899,\n",
       "          554.22164427,   280.23629107,   379.65455852,   165.72335547,\n",
       "          159.8683858 ,  1004.30764957,   106.34627805,   163.15374225,\n",
       "          716.31384524,   384.22744342,   467.50601569,   190.80454181,\n",
       "          216.94108105,   416.99727371,   168.0905097 ,   161.33563558,\n",
       "          466.36233206,  1167.84633208,   176.7223084 ,   627.31400085,\n",
       "          356.98882519,  6285.30740961,   838.67204211,   186.52119779,\n",
       "          278.24304309, 29864.37775134,   111.06740162,   179.42177353,\n",
       "          171.20408886,   310.4591679 ,   158.94575503,   181.60940071,\n",
       "          253.04695364,  1053.56576923,  1307.69889586,  1208.04514262,\n",
       "          634.40252458,   102.97534251,   462.34736935,   588.58037011,\n",
       "          129.80819391,   570.16105241,   204.7735844 ,  1884.27360298,\n",
       "         1040.51986105,   176.14371957,  1285.92841635,   315.15457001,\n",
       "          242.40687436,  1025.75297438,   109.81764027,   150.17963854,\n",
       "          660.6902692 ,   264.5571498 ,   171.13200095,   234.6779858 ,\n",
       "          757.16327404,  1047.43788847,   117.88453721,   275.86734678,\n",
       "          273.08905125,  2640.2094381 ,  2253.81021821,   413.21565759,\n",
       "          338.81161596,   493.44180041,  1739.91932914,   214.10729084,\n",
       "          183.65542837,   536.77396307,   440.71671286,  3069.47692519,\n",
       "          539.20624152,   318.97481387,  1160.03726084,   318.66308187,\n",
       "          518.00239252,   186.60279408,   180.6676692 ,   565.24556756,\n",
       "          109.34846318,   158.05166292,   294.35893225,   206.80785434,\n",
       "        26175.56870109,   817.40499178,   295.22200044,  1352.36210133,\n",
       "          114.47630726,  1170.56077299,  3187.49911199,   777.55454508,\n",
       "         6729.62051088,  1212.0632022 ,  1608.93956318,   180.43329609,\n",
       "          274.13763443,   271.40221337,   148.32800478,   780.40790433,\n",
       "          629.93704299,   849.59835782,   214.81348121,  1347.01170003,\n",
       "         1058.41920588,   301.32661781,   289.93859589,   108.88803252,\n",
       "          658.57988291,   184.30192209,   662.57223211,   109.75416985,\n",
       "         1865.35570976,   278.13226164,   923.53771418,   300.92900239,\n",
       "         1029.53347916,   196.39103338,   253.23194208,  1164.73115683,\n",
       "         4917.24372821,   636.33882215,   354.58479897,  1088.53462058,\n",
       "          270.05701745,   377.15536744,  1938.24868659,   254.24823487,\n",
       "          173.84678917,   251.16417039,   192.61306574,   419.50709591,\n",
       "          628.86089756,  1152.82969815,   896.2325109 ,   696.42648681,\n",
       "         1717.55668084,   305.78921079,   337.25324592,   172.45712477,\n",
       "          693.54556435,   188.71621532,  4663.91416639,   473.36988195,\n",
       "          115.42204314,  2379.70097025,   257.64850385,   735.81786299,\n",
       "          164.25801428,  8109.58633028,   861.49657765,   111.40882983,\n",
       "          725.26690219,   170.68372757,   136.49957361,   314.10713994,\n",
       "         1476.50899661,   121.18799382,  1380.7462448 ,  1874.65024421,\n",
       "         1078.71253455,  1794.23243858,   117.4010008 ,  1187.00047048,\n",
       "          589.71414514,   192.33678829,   437.82329142,   657.01433569,\n",
       "          242.99141263,   271.22233494, 12683.1087396 ,   408.29075101,\n",
       "          406.04040503,  1813.76569574,   775.45442419,   368.59531327,\n",
       "         1256.2679978 ,  1896.43587262,  1075.0111594 ,  1489.80344627,\n",
       "          275.20703124,   540.35160675,   408.65471764,   450.73095688,\n",
       "          223.05041231,   364.17793445,   108.50505695,   221.84454619,\n",
       "          778.27632446,   117.45806125,  1300.33860539,   272.76603908,\n",
       "          649.08534384,  1152.08021331,   234.58879622,  1615.53833905,\n",
       "          173.85925604, 76408.66548679,  1987.78756539,  2061.21885186,\n",
       "         4299.03682388, 24664.82340051, 26276.70028567,   221.902938  ,\n",
       "         6175.69235272,   265.10753412,  1947.87805191,   639.12185654,\n",
       "        10923.27083119, 11003.76235017, 15527.57218007,   786.28909582,\n",
       "         5488.42991934,  4608.48387777,  2086.14164665, 33050.85440657,\n",
       "          106.91961995, 32176.94562562,   635.66803767, 31049.25577361,\n",
       "         4296.20758203,  2599.95397702,   854.68120812, 19196.25790662,\n",
       "         3433.75660866,  5613.30383391,  4038.86628583,   445.72990803,\n",
       "        25146.86829523,   700.05722028,   883.18722375, 91849.78186613,\n",
       "        11784.98057907,   884.63121066,   967.43195317,   290.07242411]),\n",
       " 'ang_err': array([0.49140717, 0.62676821, 0.45701446, 0.65079396, 0.50103957,\n",
       "        0.96300957, 0.37058517, 0.50103957, 0.37343551, 0.62676821,\n",
       "        0.65079396, 0.96300957, 0.94838928, 0.45701446, 0.49338363,\n",
       "        2.15665906, 0.62676821, 0.65079396, 0.96300957, 0.94838928,\n",
       "        0.45701446, 0.62676821, 0.65079396, 0.50103957, 0.45701446,\n",
       "        0.96300957, 0.62676821, 0.50103957, 0.49338363, 0.63694461,\n",
       "        0.45701446, 0.62676821, 0.49140717, 0.50103957, 0.49338363,\n",
       "        0.65079396, 0.50103957, 0.49338363, 0.62676821, 0.65079396,\n",
       "        0.96300957, 0.50103957, 0.62676821, 0.45701446, 0.65079396,\n",
       "        0.49338363, 0.96300957, 0.62676821, 0.50103957, 0.65079396,\n",
       "        0.45701446, 0.96300957, 0.37343551, 0.36559617, 0.67354997,\n",
       "        0.94838928, 2.15665906, 0.49338363, 0.45701446, 0.37058517,\n",
       "        0.67354997, 0.62676821, 0.39269702, 0.49140717, 0.65079396,\n",
       "        0.96300957, 0.94838928, 0.6121606 , 0.62676821, 0.50103957,\n",
       "        0.65079396, 0.49338363, 0.63694461, 0.96300957, 0.61970789,\n",
       "        0.94838928, 2.15665906, 0.45701446, 1.39212725, 0.62676821,\n",
       "        0.50103957, 0.65079396, 0.50103957, 0.62676821, 0.67354997,\n",
       "        0.45701446, 0.62676821, 0.62676821, 0.50103957, 0.49338363,\n",
       "        0.49140717, 0.62676821, 0.65079396, 0.50103957, 0.96300957,\n",
       "        0.94838928, 0.49338363, 0.39242612, 0.62676821, 0.49140717,\n",
       "        0.49140717, 0.36559617, 0.42677885, 0.62676821, 0.62676821,\n",
       "        0.33691022, 0.65079396, 0.67354997, 0.96300957, 0.94838928,\n",
       "        0.61775148, 2.15665906, 0.75313863, 0.45701446, 0.37058517,\n",
       "        0.45701446, 0.50103957, 0.67354997, 0.49338363, 0.49140717,\n",
       "        0.61775148, 0.63694461, 0.62676821, 0.39242612, 0.37058517,\n",
       "        0.62676821, 0.45701446, 0.65079396, 0.96300957, 0.37058517,\n",
       "        0.94838928, 2.15665906, 0.50103957, 0.75313863, 1.20871444,\n",
       "        0.62676821, 0.50103957, 0.45701446, 0.65079396, 0.96300957,\n",
       "        0.94838928, 0.37058517, 0.39269702, 0.49338363, 0.63694461,\n",
       "        0.50103957, 0.45701446, 0.62676821, 0.65079396, 0.49338363,\n",
       "        0.63694461, 0.39242612, 0.50103957, 0.49338363, 0.45701446,\n",
       "        0.49140717, 0.63694461, 0.62676821, 0.62676821, 0.50103957,\n",
       "        0.65079396, 0.67354997, 0.96300957, 0.94838928, 0.30070656,\n",
       "        0.50103957, 0.62676821, 0.45701446, 0.65079396, 0.37058517,\n",
       "        0.37343551, 0.49338363, 0.29071084, 0.45701446, 0.37058517,\n",
       "        0.62676821, 0.65079396, 0.96300957, 0.94838928, 0.50103957,\n",
       "        0.49338363, 0.49140717, 0.62676821, 0.45701446, 0.39242612,\n",
       "        0.67354997, 0.65079396, 0.96300957, 0.63694461, 0.94838928,\n",
       "        0.50103957, 0.62676821, 0.39242612, 0.65079396, 0.49338363,\n",
       "        0.96300957, 0.45701446, 0.94838928, 0.67354997, 0.37058517,\n",
       "        0.37343551, 0.63694461, 0.61970789, 0.45701446, 0.62676821,\n",
       "        0.50103957, 0.37058517, 0.65079396, 0.96300957, 0.94838928,\n",
       "        2.15665906, 0.49338363, 0.50103957, 0.45701446, 0.49338363,\n",
       "        0.63694461, 0.37058517, 0.62676821, 0.49140717, 0.65079396,\n",
       "        0.50103957, 0.62676821, 0.37343551, 0.49338363, 0.65079396,\n",
       "        0.45701446, 0.62676821, 0.49140717, 0.65079396, 0.37343551,\n",
       "        0.50103957, 0.96300957, 0.49338363, 0.62676821, 0.67354997,\n",
       "        0.65079396, 0.45701446, 0.96300957, 0.45701446, 0.37058517,\n",
       "        0.39269702, 0.6121606 , 0.67354997, 0.46067803, 0.50103957,\n",
       "        0.62676821, 0.49338363, 0.63694461, 0.65079396, 0.61775148,\n",
       "        0.30070656, 0.61970789, 1.39212725, 0.47818762, 0.49140717,\n",
       "        0.97178223, 0.94466699, 0.45701446, 0.37058517, 0.39269702,\n",
       "        0.62676821, 0.50103957, 0.49140717, 0.49140717, 0.62676821,\n",
       "        0.50103957, 0.65079396, 0.96300957, 0.49338363, 0.94838928,\n",
       "        0.45701446, 0.67354997, 0.50103957, 0.37058517, 0.62676821,\n",
       "        0.39269702, 0.61775148, 0.2881142 , 0.45701446, 0.37058517,\n",
       "        0.37343551, 0.30070656, 0.25737507, 0.62676821, 0.29071084,\n",
       "        0.65079396, 0.39269702, 0.50103957, 0.26383546, 0.25717202,\n",
       "        0.3783748 , 0.49338363, 0.32658605, 0.27431317, 0.6121606 ,\n",
       "        0.25689362, 0.96300957, 0.25764991, 0.63694461, 0.46242841,\n",
       "        0.50096469, 0.46067803, 0.61970789, 0.3555539 , 0.58592145,\n",
       "        0.4423524 , 0.34452117, 1.39212725, 0.26642157, 0.97178223,\n",
       "        0.86257869, 0.25683567, 0.2570415 , 0.82919603, 0.53815153,\n",
       "        0.94838928]),\n",
       " 'ra': array([0.73549628, 3.85055176, 0.21089524, 1.73815184, 5.2388195 ,\n",
       "        6.09229449, 0.50604432, 4.41901332, 4.79014869, 1.18325839,\n",
       "        3.95570223, 4.14400611, 0.29764334, 4.06391509, 2.3210533 ,\n",
       "        0.90093821, 2.46516153, 2.20045435, 5.34884792, 0.38445284,\n",
       "        1.93881615, 2.09917545, 5.45090152, 4.81048696, 5.27366863,\n",
       "        1.99002165, 2.42844652, 3.9497847 , 1.05266434, 4.01273919,\n",
       "        2.73147151, 6.19307391, 3.2670604 , 0.20812629, 3.01315682,\n",
       "        2.6558058 , 0.84148577, 0.13507457, 4.90933271, 4.05427551,\n",
       "        5.41764078, 4.92974033, 1.7868985 , 0.9072876 , 1.13351074,\n",
       "        0.28864278, 5.61785711, 0.27231289, 5.91373337, 1.16778418,\n",
       "        5.55274954, 4.97722809, 0.91641416, 0.59534571, 4.76005001,\n",
       "        0.36146049, 2.60502135, 3.30016138, 1.10390538, 4.17887673,\n",
       "        2.23622694, 0.96072941, 0.33226777, 2.00905518, 6.09480618,\n",
       "        0.66892735, 5.02834538, 5.57794831, 5.6096347 , 4.32677652,\n",
       "        5.00294812, 5.78294222, 1.89492321, 0.13738058, 0.07943041,\n",
       "        0.71436568, 5.88609869, 6.08501135, 6.23557176, 2.38970764,\n",
       "        3.9218431 , 0.83247953, 0.08548091, 2.09773753, 6.13869938,\n",
       "        2.54014483, 4.09943864, 6.17914604, 2.78894383, 1.42676407,\n",
       "        5.77987739, 5.40481924, 0.64208254, 3.57812806, 5.60249028,\n",
       "        4.61939964, 1.20036536, 4.83705401, 2.8555907 , 0.31501433,\n",
       "        5.70343754, 5.02356778, 4.2349356 , 3.7366772 , 0.84689901,\n",
       "        1.52596192, 2.6825374 , 5.58911928, 0.6913619 , 5.50570078,\n",
       "        5.87872301, 1.04389119, 3.87777884, 4.35002576, 1.15107247,\n",
       "        0.62050079, 4.57420809, 0.0450209 , 6.18599433, 0.8320906 ,\n",
       "        0.59027758, 4.0729724 , 0.79405975, 5.92304615, 1.77924751,\n",
       "        4.44812258, 2.70919829, 4.61064582, 3.30515778, 5.70945833,\n",
       "        5.99313818, 3.45827724, 4.51809747, 2.94233076, 1.11711991,\n",
       "        4.56908816, 4.8282321 , 1.38506639, 4.04968131, 3.49565649,\n",
       "        3.82120383, 5.59527347, 0.38478193, 1.86828829, 1.1841903 ,\n",
       "        1.98378885, 5.61925985, 4.48165833, 3.40928223, 0.17007483,\n",
       "        3.63121962, 1.6297054 , 1.32446653, 0.68898169, 4.24160562,\n",
       "        6.14891131, 2.38081746, 1.16261873, 4.2297646 , 2.65091544,\n",
       "        4.29929157, 1.5341315 , 3.21239974, 5.63439758, 1.03360687,\n",
       "        1.83449229, 4.66197948, 2.84090807, 1.46872405, 1.79864733,\n",
       "        1.85427997, 2.26809669, 5.69606311, 2.14513284, 0.49498087,\n",
       "        0.6322086 , 5.77815323, 1.46879557, 1.38691949, 3.68146889,\n",
       "        6.04141471, 5.432853  , 2.95583943, 0.79014305, 0.09479262,\n",
       "        0.9337465 , 3.706684  , 6.03789622, 2.02224581, 4.14627386,\n",
       "        2.15389406, 2.92422004, 0.8517107 , 4.0954088 , 5.07257996,\n",
       "        1.0056314 , 3.187928  , 0.99728556, 4.3292795 , 3.25861158,\n",
       "        0.97492733, 3.72875619, 5.11675221, 4.45312033, 1.02090652,\n",
       "        1.53156051, 1.2144621 , 1.28575169, 1.23606569, 0.43166916,\n",
       "        0.7720166 , 1.41686478, 2.79100742, 4.76177449, 1.54452765,\n",
       "        1.843163  , 3.24197371, 1.71220563, 3.68622821, 0.59084841,\n",
       "        1.0604718 , 5.03693162, 5.89058288, 2.06597908, 0.95393503,\n",
       "        2.70403243, 1.67228721, 6.16784117, 1.30905069, 2.04876856,\n",
       "        2.80371451, 3.84928967, 3.42773432, 2.93933517, 3.31328724,\n",
       "        0.83401819, 4.62119897, 2.12716387, 6.24704724, 5.4980012 ,\n",
       "        5.44715483, 0.04981811, 1.38681642, 5.57056327, 0.44814003,\n",
       "        5.72297344, 1.19572003, 4.14140808, 3.50681255, 2.20045216,\n",
       "        2.52899275, 1.19361456, 2.03597333, 2.71269871, 5.78585691,\n",
       "        4.68918457, 4.19695972, 5.03650563, 3.33817176, 4.20654029,\n",
       "        4.48281928, 3.0634576 , 4.05417013, 2.85906275, 2.74912683,\n",
       "        5.27820955, 4.80196228, 5.63505077, 3.10314735, 3.94306561,\n",
       "        2.01024655, 3.84026547, 4.33978357, 0.1015756 , 4.70388328,\n",
       "        5.59239601, 1.48538065, 3.13488573, 3.1497318 , 3.13251296,\n",
       "        3.13808076, 3.13997827, 3.14334963, 3.15375623, 3.14461751,\n",
       "        3.13404364, 3.13999892, 3.15033115, 3.14662769, 3.13728271,\n",
       "        3.14297051, 3.14906812, 3.14006087, 3.14082116, 3.14777758,\n",
       "        3.14343829, 3.15415464, 3.14022876, 3.15386937, 3.15439439,\n",
       "        3.13901042, 3.14034883, 3.15321983, 3.14362613, 3.14458463,\n",
       "        3.140988  , 3.1366311 , 3.11980729, 3.14559529, 3.1597099 ,\n",
       "        3.12965822, 3.1375832 , 3.13839266, 3.13695975, 3.14207285,\n",
       "        3.15974811]),\n",
       " 'dec': array([ 0.14853443,  0.73222674,  1.29529395,  0.6444955 ,  1.01055903,\n",
       "         1.45872795,  0.33665614,  0.20602661,  0.69789964,  1.07225234,\n",
       "         0.41992314,  0.87742331,  1.00485268,  0.27844937,  1.407768  ,\n",
       "         0.78093307,  1.40327195,  0.59898524,  1.44830512,  0.50616441,\n",
       "         0.79933315,  1.31199959,  1.07235619,  0.21738172,  1.0368054 ,\n",
       "         1.089801  ,  0.52438532,  0.22133937,  0.37445419,  0.8922938 ,\n",
       "         0.9967535 ,  1.12779015,  0.01777343,  0.22941579,  0.71082191,\n",
       "         0.75848719,  0.32116641,  0.29876474,  0.98353445,  1.08654436,\n",
       "         0.53173358,  0.5196838 ,  0.20161646,  0.39058777,  0.50406695,\n",
       "         0.3711511 ,  0.96279116,  1.00567621,  0.37528668,  0.9552809 ,\n",
       "         1.00203925,  0.86259202,  0.90200786,  0.15392494,  0.01206387,\n",
       "         0.62437785,  0.77269248,  0.73301498,  0.24197969,  0.75960949,\n",
       "         0.16298338,  0.74850303,  0.18235419, -0.04112618,  0.69639608,\n",
       "         0.8821865 ,  0.92642641,  0.93879869,  0.54722073,  0.17586322,\n",
       "         0.35877146,  0.20056396,  0.1932984 ,  0.96793154,  0.25585318,\n",
       "         1.12046092,  1.17988772,  0.83906523,  1.21634577,  0.95174161,\n",
       "         0.39717825,  0.99474793,  0.35002453,  0.58082291,  0.05344967,\n",
       "         1.46198183,  1.09829413,  0.68695331,  0.23338838,  1.04346425,\n",
       "         0.02441075,  0.56566219,  0.62529406,  0.36409285,  0.5682431 ,\n",
       "         0.5137199 ,  0.73893809,  0.00547531,  1.04044695,  0.00821565,\n",
       "         0.06170506,  0.12884343, -0.02352726,  0.63708396,  1.08489649,\n",
       "         0.0712893 ,  0.76996448,  0.07608575,  0.40694725,  0.93718435,\n",
       "         0.10637276,  0.85671643,  1.01559718,  0.9615695 ,  0.86279914,\n",
       "         0.68280917,  0.25757286, -0.0383117 ,  0.75101331,  0.08626089,\n",
       "         0.15459867,  1.21079701,  1.30590138,  0.09189471,  0.34046693,\n",
       "         0.37303192,  0.90995081,  1.14321781,  0.47744365,  0.71902919,\n",
       "         0.8286986 ,  1.21466092,  0.84579317,  0.57596184,  0.25297863,\n",
       "         0.6468617 ,  0.45915697,  0.63656402,  0.36847205,  0.46657166,\n",
       "         0.92549559,  0.53813018,  1.07113466,  0.45534858,  0.75827408,\n",
       "         1.11292003,  0.78261513,  0.79385193,  0.67286019,  1.05969013,\n",
       "         1.24633592,  0.07189625,  0.96250656,  0.50702115,  0.18783587,\n",
       "         0.07470569,  0.5333412 ,  0.53807288,  0.21076411,  0.52799293,\n",
       "         0.97872902,  0.1095485 ,  1.00266112,  1.08225394,  1.17583699,\n",
       "         0.32548609,  0.29295858,  0.90842221,  0.3274389 ,  0.66514812,\n",
       "         0.49040012,  0.56274759,  0.91761829,  0.91120996,  0.54701967,\n",
       "         0.97566563,  0.54521953,  0.76151581,  0.490914  ,  0.45713012,\n",
       "         0.51105299,  0.17366373,  0.2812266 ,  0.38578853,  0.12559407,\n",
       "         0.06042488,  0.21446738,  0.51576473,  0.19211132,  0.45786477,\n",
       "         0.35202014,  0.76411506,  0.09989345,  0.95264799,  0.30720926,\n",
       "         1.27673716,  0.32407818,  1.13479829,  0.02855067,  0.3140412 ,\n",
       "         1.04753079,  0.90879439,  0.47071046,  0.30571838,  0.58562348,\n",
       "         0.60318889,  0.2061972 ,  0.67668345,  0.62839903,  0.91704287,\n",
       "         0.18000136,  0.30988803,  0.94201039,  1.08243806,  0.69478141,\n",
       "         1.24279698,  1.2392877 ,  0.73471677,  0.00233486,  0.32552734,\n",
       "         1.08879524,  0.95469234,  0.38818358,  1.41168402,  1.37820022,\n",
       "         0.49830182,  1.47264678,  0.06993321,  0.87901863,  0.61466708,\n",
       "         1.08404837,  0.17664104,  0.74228985,  0.75681255,  0.01925721,\n",
       "         0.6100749 ,  0.31658279,  0.3891416 ,  0.17626656,  0.27424548,\n",
       "         0.22175102,  0.60333394,  0.01005552,  1.09236708,  0.18143322,\n",
       "         0.20624302,  0.98924527,  0.28970295,  0.22174258,  0.10380147,\n",
       "         0.7026353 ,  0.52324269,  0.21719043,  0.58960977, -0.01067885,\n",
       "         0.52073737,  0.75505605,  0.96061347,  0.36214943,  0.36182249,\n",
       "         1.43273576,  0.37131472, -0.07339068,  0.04173366,  0.95016718,\n",
       "         0.42513388,  0.52262765,  0.55186675,  1.25872117,  0.3948084 ,\n",
       "         0.21765441,  0.05472384,  0.93090653,  0.67641447,  0.26222228,\n",
       "         0.59976107,  0.00656845,  0.51849688,  0.53085739,  0.52151348,\n",
       "         0.52457277,  0.52515332,  0.52147227,  0.52179907,  0.52513397,\n",
       "         0.52568056,  0.51505182,  0.51150338,  0.52593565,  0.52267319,\n",
       "         0.52531722,  0.51906194,  0.5211586 ,  0.51863928,  0.51981826,\n",
       "         0.51659885,  0.52251602,  0.52360414,  0.50864449,  0.52346208,\n",
       "         0.52358734,  0.52740193,  0.51599838,  0.52762166,  0.5201626 ,\n",
       "         0.52320038,  0.53142933,  0.52109675,  0.52166271,  0.51795559,\n",
       "         0.50936353,  0.52816699,  0.51725829,  0.53341911,  0.5271981 ,\n",
       "         0.53466131]),\n",
       " 'source_label': array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n",
       "        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n",
       "        1, 1, 1, 1, 1, 1, 1, 1])}"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "events.period(\"IC86_II\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "461c73eb",
   "metadata": {},
   "source": [
    "Through the method `apply_mask()` a mask is applied and a nested dictionary (1st key is period, 2nd key is name of the data field, as returned by `keys`) is returned containing the selected events. The order of entries in mask needs to be the same as the periods in `events.periods`. For application, see the notebook on point source analysis."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "icecube_dev",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.16"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
