{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "bcb8790a",
   "metadata": {},
   "source": [
    "# Source model interface\n",
    "\n",
    "`icecube_tools` has a simple source modelling interface built in that we demonstrate here."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "48c169ee",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-16T10:05:59.284953Z",
     "iopub.status.busy": "2022-08-16T10:05:59.284667Z",
     "iopub.status.idle": "2022-08-16T10:06:00.218387Z",
     "shell.execute_reply": "2022-08-16T10:06:00.217658Z"
    }
   },
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "from matplotlib import pyplot as plt\n",
    "\n",
    "from icecube_tools.source.flux_model import PowerLawFlux, BrokenPowerLawFlux\n",
    "from icecube_tools.source.source_model import PointSource, DiffuseSource"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "221369f9",
   "metadata": {},
   "source": [
    "## Spectral shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ffebf206",
   "metadata": {},
   "source": [
    "We start by defining a spectral shape, such as a power law or broken power law. Let's start with the definition of a simple power law flux."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "32e0a8e0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-16T10:06:00.223151Z",
     "iopub.status.busy": "2022-08-16T10:06:00.222646Z",
     "iopub.status.idle": "2022-08-16T10:06:00.227852Z",
     "shell.execute_reply": "2022-08-16T10:06:00.227251Z"
    }
   },
   "outputs": [],
   "source": [
    "# Parameters of power law flux\n",
    "flux_norm = 1e-18  # Flux normalisation in units of GeV^-1 cm^-2 s^-1 (sr^-1)\n",
    "norm_energy = 1e5  # Energy of normalisation in units of GeV\n",
    "spectral_index = 2.0  # Assumed negative slope\n",
    "min_energy = 1e4  # GeV\n",
    "max_energy = 1e8  # GeV\n",
    "\n",
    "# Instantiate\n",
    "power_law = PowerLawFlux(flux_norm, norm_energy, spectral_index, min_energy, max_energy)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "8f4878b9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-16T10:06:00.231288Z",
     "iopub.status.busy": "2022-08-16T10:06:00.230944Z",
     "iopub.status.idle": "2022-08-16T10:06:00.821780Z",
     "shell.execute_reply": "2022-08-16T10:06:00.821003Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0, 0.5, 'F [GeV^-1 cm^-2 s^-1 (sr^-1)]')"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "energies = np.geomspace(min_energy, max_energy)\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(energies, [power_law.spectrum(e) for e in energies])\n",
    "ax.axhline(flux_norm, color=\"k\", linestyle=\":\")\n",
    "ax.axvline(norm_energy, color=\"k\", linestyle=\":\")\n",
    "ax.set_xscale(\"log\")\n",
    "ax.set_yscale(\"log\")\n",
    "ax.set_xlabel(\"E [GeV]\")\n",
    "ax.set_ylabel(\"F [GeV^-1 cm^-2 s^-1 (sr^-1)]\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "524189a9",
   "metadata": {},
   "source": [
    "We can also use the `PowerLawFlux` class to perform some simple calculations, such as integration of the flux."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "711eb180",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-16T10:06:00.825461Z",
     "iopub.status.busy": "2022-08-16T10:06:00.824875Z",
     "iopub.status.idle": "2022-08-16T10:06:00.829949Z",
     "shell.execute_reply": "2022-08-16T10:06:00.829249Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "9.999000000000002e-13"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_flux = power_law.integrated_spectrum(min_energy, max_energy)  # cm^-2 s^-1 (sr^-1)\n",
    "total_flux"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "03b15909",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-16T10:06:00.833261Z",
     "iopub.status.busy": "2022-08-16T10:06:00.832646Z",
     "iopub.status.idle": "2022-08-16T10:06:00.837422Z",
     "shell.execute_reply": "2022-08-16T10:06:00.836778Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "9.210340371976182e-08"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_energy_flux = power_law.total_flux_density()  # GeV cm^-2 s^-1 (sr^-1)\n",
    "total_energy_flux"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "818050bd",
   "metadata": {},
   "source": [
    "Sampling from the power law shape is also possible:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "80379b99",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-16T10:06:00.841075Z",
     "iopub.status.busy": "2022-08-16T10:06:00.840475Z",
     "iopub.status.idle": "2022-08-16T10:06:01.503479Z",
     "shell.execute_reply": "2022-08-16T10:06:01.502576Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.legend.Legend at 0x7f1b73841fd0>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "samples = power_law.sample(1000)\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.hist(samples, bins=energies, density=True, label=\"Samples\")\n",
    "ax.plot(energies, [power_law.spectrum(e) / total_flux for e in energies], label=\"Model\")\n",
    "ax.set_xscale(\"log\")\n",
    "ax.set_yscale(\"log\")\n",
    "ax.set_xlabel(\"E [GeV]\")\n",
    "ax.legend()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e47be1cf",
   "metadata": {},
   "source": [
    "The `BrokenPowerLaw` class is also available and behaves in a very similar way."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b5496949",
   "metadata": {},
   "source": [
    "## Diffuse and point sources\n",
    "\n",
    "Once the spectral shape is defined, we can specify either a `DiffuseSource` or a `PointSource`. It is assumed that diffuse sources are isotropic and the flux model describes the per-steradian flux over the entire $4\\pi$ sky. We also specify a redshift of the source such that adiabatic neutrino energy losses can be accounted for. Naturally, `PointSource` objects also have a direction specified in (ra, dec) coordinates."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "43e3aae5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-16T10:06:01.507140Z",
     "iopub.status.busy": "2022-08-16T10:06:01.506494Z",
     "iopub.status.idle": "2022-08-16T10:06:01.510835Z",
     "shell.execute_reply": "2022-08-16T10:06:01.510146Z"
    }
   },
   "outputs": [],
   "source": [
    "diffuse_source = DiffuseSource(power_law, z=0.0)\n",
    "\n",
    "ra = np.deg2rad(50)\n",
    "dec = np.deg2rad(-10)\n",
    "point_source = PointSource(power_law, z=0.5, coord=(ra, dec))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2dce7b12",
   "metadata": {},
   "source": [
    "The original flux model can now be accessed from within the source along with its other properties:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "a2335cac",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-16T10:06:01.513749Z",
     "iopub.status.busy": "2022-08-16T10:06:01.513523Z",
     "iopub.status.idle": "2022-08-16T10:06:01.518149Z",
     "shell.execute_reply": "2022-08-16T10:06:01.517493Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<icecube_tools.source.flux_model.PowerLawFlux at 0x7f1bacc7e7c0>"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "diffuse_source.flux_model"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "619864fd",
   "metadata": {},
   "source": [
    "Sources and lists of sources can be used as input to simulations, as demonstrated in the simulation notebook."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "15379815",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
