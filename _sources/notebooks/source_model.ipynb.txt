{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "05b58c39",
   "metadata": {},
   "source": [
    "# Source model interface\n",
    "\n",
    "`icecube_tools` has a simple source modelling interface built in that we demonstrate here."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e9d5c8c7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-30T21:30:47.759717Z",
     "iopub.status.busy": "2021-12-30T21:30:47.759094Z",
     "iopub.status.idle": "2021-12-30T21:30:48.749890Z",
     "shell.execute_reply": "2021-12-30T21:30:48.749281Z"
    }
   },
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "from matplotlib import pyplot as plt\n",
    "\n",
    "from icecube_tools.source.flux_model import PowerLawFlux, BrokenPowerLawFlux\n",
    "from icecube_tools.source.source_model import PointSource, DiffuseSource"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3193a4bb",
   "metadata": {},
   "source": [
    "## Spectral shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6a0b006b",
   "metadata": {},
   "source": [
    "We start by defining a spectral shape, such as a power law or broken power law. Let's start with the definition of a simple power law flux."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "41a010ab",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-30T21:30:48.754482Z",
     "iopub.status.busy": "2021-12-30T21:30:48.754017Z",
     "iopub.status.idle": "2021-12-30T21:30:48.756653Z",
     "shell.execute_reply": "2021-12-30T21:30:48.757018Z"
    }
   },
   "outputs": [],
   "source": [
    "# Parameters of power law flux\n",
    "flux_norm = 1e-18  # Flux normalisation in units of GeV^-1 cm^-2 s^-1 (sr^-1)\n",
    "norm_energy = 1e5  # Energy of normalisation in units of GeV\n",
    "spectral_index = 2.0  # Assumed negative slope\n",
    "min_energy = 1e4  # GeV\n",
    "max_energy = 1e8  # GeV\n",
    "\n",
    "# Instantiate\n",
    "power_law = PowerLawFlux(flux_norm, norm_energy, spectral_index, min_energy, max_energy)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "4fc9af98",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-30T21:30:48.765564Z",
     "iopub.status.busy": "2021-12-30T21:30:48.762071Z",
     "iopub.status.idle": "2021-12-30T21:30:49.261220Z",
     "shell.execute_reply": "2021-12-30T21:30:49.261617Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0, 0.5, 'F [GeV^-1 cm^-2 s^-1 (sr^-1)]')"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "energies = np.geomspace(min_energy, max_energy)\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(energies, [power_law.spectrum(e) for e in energies])\n",
    "ax.axhline(flux_norm, color=\"k\", linestyle=\":\")\n",
    "ax.axvline(norm_energy, color=\"k\", linestyle=\":\")\n",
    "ax.set_xscale(\"log\")\n",
    "ax.set_yscale(\"log\")\n",
    "ax.set_xlabel(\"E [GeV]\")\n",
    "ax.set_ylabel(\"F [GeV^-1 cm^-2 s^-1 (sr^-1)]\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bfee40af",
   "metadata": {},
   "source": [
    "We can also use the `PowerLawFlux` class to perform some simple calculations, such as integration of the flux."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "084c34a3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-30T21:30:49.266008Z",
     "iopub.status.busy": "2021-12-30T21:30:49.265549Z",
     "iopub.status.idle": "2021-12-30T21:30:49.270126Z",
     "shell.execute_reply": "2021-12-30T21:30:49.269724Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "9.999000000000002e-13"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_flux = power_law.integrated_spectrum(min_energy, max_energy)  # cm^-2 s^-1 (sr^-1)\n",
    "total_flux"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "f036d53a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-30T21:30:49.274008Z",
     "iopub.status.busy": "2021-12-30T21:30:49.273565Z",
     "iopub.status.idle": "2021-12-30T21:30:49.277880Z",
     "shell.execute_reply": "2021-12-30T21:30:49.277490Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "9.210340371976182e-08"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_energy_flux = power_law.total_flux_density()  # GeV cm^-2 s^-1 (sr^-1)\n",
    "total_energy_flux"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "84ff4360",
   "metadata": {},
   "source": [
    "Sampling from the power law shape is also possible:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "53f5d073",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-30T21:30:49.282658Z",
     "iopub.status.busy": "2021-12-30T21:30:49.282208Z",
     "iopub.status.idle": "2021-12-30T21:30:49.811865Z",
     "shell.execute_reply": "2021-12-30T21:30:49.811405Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.legend.Legend at 0x7f03f7437e80>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "samples = power_law.sample(1000)\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.hist(samples, bins=energies, density=True, label=\"Samples\")\n",
    "ax.plot(energies, [power_law.spectrum(e) / total_flux for e in energies], label=\"Model\")\n",
    "ax.set_xscale(\"log\")\n",
    "ax.set_yscale(\"log\")\n",
    "ax.set_xlabel(\"E [GeV]\")\n",
    "ax.legend()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dbc07936",
   "metadata": {},
   "source": [
    "The `BrokenPowerLaw` class is also available and behaves in a very similar way."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "085ef5fe",
   "metadata": {},
   "source": [
    "## Diffuse and point sources\n",
    "\n",
    "Once the spectral shape is defined, we can specify either a `DiffuseSource` or a `PointSource`. It is assumed that diffuse sources are isotropic and the flux model describes the per-steradian flux over the entire $4\\pi$ sky. We also specify a redshift of the source such that adiabatic neutrino energy losses can be accounted for. Naturally, `PointSource` objects also have a direction specified in (ra, dec) coordinates."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "e494eb8e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-30T21:30:49.816636Z",
     "iopub.status.busy": "2021-12-30T21:30:49.816110Z",
     "iopub.status.idle": "2021-12-30T21:30:49.818841Z",
     "shell.execute_reply": "2021-12-30T21:30:49.819186Z"
    }
   },
   "outputs": [],
   "source": [
    "diffuse_source = DiffuseSource(power_law, z=0.0)\n",
    "\n",
    "ra = np.deg2rad(50)\n",
    "dec = np.deg2rad(-10)\n",
    "point_source = PointSource(power_law, z=0.5, coord=(ra, dec))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "14b651f1",
   "metadata": {},
   "source": [
    "The original flux model can now be accessed from within the source along with its other properties:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "b989c150",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-12-30T21:30:49.823817Z",
     "iopub.status.busy": "2021-12-30T21:30:49.823347Z",
     "iopub.status.idle": "2021-12-30T21:30:49.825650Z",
     "shell.execute_reply": "2021-12-30T21:30:49.826013Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<icecube_tools.source.flux_model.PowerLawFlux at 0x7f03f97c7820>"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "diffuse_source.flux_model"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4940463e",
   "metadata": {},
   "source": [
    "Sources and lists of sources can be used as input to simulations, as demonstrated in the simulation notebook."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5aac23b",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
