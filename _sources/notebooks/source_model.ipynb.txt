{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "afc0d900",
   "metadata": {},
   "source": [
    "# Source model interface\n",
    "\n",
    "`icecube_tools` has a simple source modelling interface built in that we demonstrate here."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "0b3edd18",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-18T23:10:52.230373Z",
     "iopub.status.busy": "2022-01-18T23:10:52.229683Z",
     "iopub.status.idle": "2022-01-18T23:10:53.597924Z",
     "shell.execute_reply": "2022-01-18T23:10:53.596961Z"
    }
   },
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "from matplotlib import pyplot as plt\n",
    "\n",
    "from icecube_tools.source.flux_model import PowerLawFlux, BrokenPowerLawFlux\n",
    "from icecube_tools.source.source_model import PointSource, DiffuseSource"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7da51e44",
   "metadata": {},
   "source": [
    "## Spectral shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "30d27136",
   "metadata": {},
   "source": [
    "We start by defining a spectral shape, such as a power law or broken power law. Let's start with the definition of a simple power law flux."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "f351e77d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-18T23:10:53.603984Z",
     "iopub.status.busy": "2022-01-18T23:10:53.603108Z",
     "iopub.status.idle": "2022-01-18T23:10:53.607389Z",
     "shell.execute_reply": "2022-01-18T23:10:53.606544Z"
    }
   },
   "outputs": [],
   "source": [
    "# Parameters of power law flux\n",
    "flux_norm = 1e-18  # Flux normalisation in units of GeV^-1 cm^-2 s^-1 (sr^-1)\n",
    "norm_energy = 1e5  # Energy of normalisation in units of GeV\n",
    "spectral_index = 2.0  # Assumed negative slope\n",
    "min_energy = 1e4  # GeV\n",
    "max_energy = 1e8  # GeV\n",
    "\n",
    "# Instantiate\n",
    "power_law = PowerLawFlux(flux_norm, norm_energy, spectral_index, min_energy, max_energy)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "357d173e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-18T23:10:53.637497Z",
     "iopub.status.busy": "2022-01-18T23:10:53.636856Z",
     "iopub.status.idle": "2022-01-18T23:10:54.402859Z",
     "shell.execute_reply": "2022-01-18T23:10:54.402288Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0, 0.5, 'F [GeV^-1 cm^-2 s^-1 (sr^-1)]')"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "energies = np.geomspace(min_energy, max_energy)\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.plot(energies, [power_law.spectrum(e) for e in energies])\n",
    "ax.axhline(flux_norm, color=\"k\", linestyle=\":\")\n",
    "ax.axvline(norm_energy, color=\"k\", linestyle=\":\")\n",
    "ax.set_xscale(\"log\")\n",
    "ax.set_yscale(\"log\")\n",
    "ax.set_xlabel(\"E [GeV]\")\n",
    "ax.set_ylabel(\"F [GeV^-1 cm^-2 s^-1 (sr^-1)]\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b45e58dc",
   "metadata": {},
   "source": [
    "We can also use the `PowerLawFlux` class to perform some simple calculations, such as integration of the flux."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "dfec3fed",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-18T23:10:54.408872Z",
     "iopub.status.busy": "2022-01-18T23:10:54.408227Z",
     "iopub.status.idle": "2022-01-18T23:10:54.413021Z",
     "shell.execute_reply": "2022-01-18T23:10:54.413532Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "9.999000000000002e-13"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_flux = power_law.integrated_spectrum(min_energy, max_energy)  # cm^-2 s^-1 (sr^-1)\n",
    "total_flux"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "de1ca5c3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-18T23:10:54.420785Z",
     "iopub.status.busy": "2022-01-18T23:10:54.419508Z",
     "iopub.status.idle": "2022-01-18T23:10:54.423511Z",
     "shell.execute_reply": "2022-01-18T23:10:54.422851Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "9.210340371976183e-08"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_energy_flux = power_law.total_flux_density()  # GeV cm^-2 s^-1 (sr^-1)\n",
    "total_energy_flux"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a634688f",
   "metadata": {},
   "source": [
    "Sampling from the power law shape is also possible:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "91f93a86",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-18T23:10:54.437299Z",
     "iopub.status.busy": "2022-01-18T23:10:54.426250Z",
     "iopub.status.idle": "2022-01-18T23:10:55.329439Z",
     "shell.execute_reply": "2022-01-18T23:10:55.330479Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.legend.Legend at 0x7f984039c220>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "samples = power_law.sample(1000)\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "ax.hist(samples, bins=energies, density=True, label=\"Samples\")\n",
    "ax.plot(energies, [power_law.spectrum(e) / total_flux for e in energies], label=\"Model\")\n",
    "ax.set_xscale(\"log\")\n",
    "ax.set_yscale(\"log\")\n",
    "ax.set_xlabel(\"E [GeV]\")\n",
    "ax.legend()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "062466f9",
   "metadata": {},
   "source": [
    "The `BrokenPowerLaw` class is also available and behaves in a very similar way."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5626a961",
   "metadata": {},
   "source": [
    "## Diffuse and point sources\n",
    "\n",
    "Once the spectral shape is defined, we can specify either a `DiffuseSource` or a `PointSource`. It is assumed that diffuse sources are isotropic and the flux model describes the per-steradian flux over the entire $4\\pi$ sky. We also specify a redshift of the source such that adiabatic neutrino energy losses can be accounted for. Naturally, `PointSource` objects also have a direction specified in (ra, dec) coordinates."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "11a3eec6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-18T23:10:55.338684Z",
     "iopub.status.busy": "2022-01-18T23:10:55.336893Z",
     "iopub.status.idle": "2022-01-18T23:10:55.339571Z",
     "shell.execute_reply": "2022-01-18T23:10:55.340290Z"
    }
   },
   "outputs": [],
   "source": [
    "diffuse_source = DiffuseSource(power_law, z=0.0)\n",
    "\n",
    "ra = np.deg2rad(50)\n",
    "dec = np.deg2rad(-10)\n",
    "point_source = PointSource(power_law, z=0.5, coord=(ra, dec))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d3e8fcb7",
   "metadata": {},
   "source": [
    "The original flux model can now be accessed from within the source along with its other properties:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "beb80648",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-18T23:10:55.349435Z",
     "iopub.status.busy": "2022-01-18T23:10:55.346263Z",
     "iopub.status.idle": "2022-01-18T23:10:55.354623Z",
     "shell.execute_reply": "2022-01-18T23:10:55.353781Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<icecube_tools.source.flux_model.PowerLawFlux at 0x7f9878c476a0>"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "diffuse_source.flux_model"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "99ea6113",
   "metadata": {},
   "source": [
    "Sources and lists of sources can be used as input to simulations, as demonstrated in the simulation notebook."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4c67df30",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
